<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="/css/settings.css" />
    <link rel="stylesheet" type="text/css" href="/css/themes.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
    <script type="text/javascript">
      (function (c, l, a, r, i, t, y) {
        c[a] =
          c[a] ||
          function () {
            (c[a].q = c[a].q || []).push(arguments);
          };
        t = l.createElement(r);
        t.async = 1;
        t.src = "https://www.clarity.ms/tag/" + i;
        y = l.getElementsByTagName(r)[0];
        y.parentNode.insertBefore(t, y);
      })(window, document, "clarity", "script", "pwiasnexu5");
    </script>
    <script src="/js/settings.js" defer></script>
    <script src="/js/themes.js"></script>
    <title>Settings Panel</title>
    <style>
      .switch {
        position: relative;
        display: inline-block;
        width: 60px;
        height: 34px;
      }
      
      .switch input {
        opacity: 0;
        width: 0;
        height: 0;
      }
      
      .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #ccc;
        transition: 0.4s;
        border-radius: 34px;
      }
      
      .slider:before {
        position: absolute;
        content: "";
        height: 26px;
        width: 26px;
        left: 4px;
        bottom: 4px;
        background-color: white;
        transition: 0.4s;
        border-radius: 50%;
      }
      
      input:checked + .slider {
        background-color: #2196F3;
      }
      
      input:checked + .slider:before {
        transform: translateX(26px);
      }
    </style>
  </head>

  <body>
    <div class="settings-container">
      <div class="panel" id="particles-settings">
        <label for="particles-input">Tab Cloaking</label>
        <input type="text" id="name-input" placeholder="Tab Name" />
        <input type="text" id="icon-input" placeholder="Tab Icon" />
        <button
          type="button"
          onclick="setCloak(document.getElementById('name-input').value, document.getElementById('icon-input').value)"
        >
          Save
        </button>
      </div>

      <div class="panel" id="themes-settings">
        <label>Choose Theme</label>
        <select id="theme-select">
          <option value="default">Default</option>
          <option value="midnight">Midnight</option>
          <option value="dark-cool">Dark</option>
          <option value="monochrome">Monochrome</option>
          <option value="night-neon">Night Neon</option>
          <option value="pastel-dark">Pastel Dark</option>
          <option value="hacker">Hacker</option>
          <option value="oceanic">Oceanic</option>
          <option value="galaxy">Galaxy</option>
          <option value="gaming">Gaming</option>
          <option value="cyberpunk">Cyberpunk</option>
          <option value="techno">Techno</option>
          <option value="crimson">Crimson</option>
          <option value="halloween">Halloween</option>
          <option value="noctura">Noctura</option>
          <option value="sapphire">Sapphire</option>
          <option value="fire">Fire</option>
        </select>
        <button type="button" id="save-theme-button" onclick="saveTheme()">
          Save Theme
        </button>
      </div>

      <div class="panel" id="close-settings">
        <label for="image-url">Anti-Close</label>
        <p class="description" id="antiCloseStatus">
          Current status:&NonBreakingSpace;
        </p>
        <button
          type="button"
          onclick="localStorage.setItem('closeProt', 'enabled'); top.onbeforeunload = function (e) { e.preventDefault(); return true; }; document.getElementById('antiCloseStatus').textContent = 'Current status: enabled'"
        >
          Enable Anti-Close
        </button>
        <button
          type="button"
          onclick="localStorage.setItem('closeProt', 'disabled'); top.onbeforeunload = null; document.getElementById('antiCloseStatus').textContent = 'Current status: disabled'"
        >
          Disable Anti-Close
        </button>
      </div>

      <div class="panel" id="image-settings">
        <label for="image-url">Plugins</label>
        <p class="description">
          Plugins are similar to Chrome extensions. You can enable and disable
          them to change how the browser works!
        </p>
        <button type="button">Edit Plugins</button>
      </div>

      <div class="panel" id="background-settings">
        <label>Upload Background</label>
        <p class="description">
          Provide the URL of the image you want to use as a background.
        </p>
        <button
          type="button"
          id="background-upload-button"
          onclick="document.getElementById('background-upload').click();"
        >
          Choose a file
        </button>
        <input
          type="file"
          id="background-upload"
          accept="image/*"
          onchange="updateButtonText()"
          style="display: none"
        />
      </div>

      <!-- Panic Key -->
      <div class="panel" id="panic-settings">
        <label>Panic Key</label>
        <p class="description">Press any key combination:</p>
        <input type="text" id="panicKeybind" readonly />
        <button
          type="button"
          onclick="localStorage.setItem('panicKey', document.getElementById('panicKeybind').value)"
        >
          Save
        </button>
      </div>

      <div class="panel" id="particle-web-settings">
        <p class="description">Toggle Particals</p>
        <label class="switch">
          <input type="checkbox" id="particle-switch" />
          <span class="slider"></span>
        </label>
      </div>
    </div>

    <script>
      // Urm what the sigma
      document.getElementById("name-input").value =
        JSON.parse(localStorage.getItem("cloak"))?.title ?? "Acceleration";
      document.getElementById("icon-input").value =
        JSON.parse(localStorage.getItem("cloak"))?.icon ?? "/favicon.ico";
      document.getElementById("panicKeybind").value =
        localStorage.getItem("panicKey") ?? "Shift+~";
      document.getElementById("antiCloseStatus").innerText +=
        localStorage.getItem("closeProt") ?? "disabled";
      document.getElementById("theme-select").value =
        localStorage.getItem("theme") ?? "default";

      // skibidi toilet
      (function () {
        let particlesEnabled = localStorage.getItem("particlesEnabled") === "true";
        const particleSwitch = document.getElementById("particle-switch");
        particleSwitch.checked = particlesEnabled;
        if (particlesEnabled) {
          enableParticles();
        }
      })();

      document.getElementById("particle-switch").addEventListener("change", function () {
        if (this.checked) {
          enableParticles();
          localStorage.setItem("particlesEnabled", "true");
        } else {
          disableParticles();
          localStorage.setItem("particlesEnabled", "false");
        }
      });

      const panicKeybindInput = document.getElementById("panicKeybind");
      panicKeybindInput.addEventListener("focus", () => {
        document.addEventListener("keydown", handlepanicKeybindInput);
      });
      panicKeybindInput.addEventListener("blur", () => {
        document.removeEventListener("keydown", handlepanicKeybindInput);
      });
      function handlepanicKeybindInput(event) {
        event.preventDefault();
        const key = event.key;
        const modifiers = [];
        if (event.ctrlKey) modifiers.push("Ctrl");
        if (event.shiftKey) modifiers.push("Shift");
        if (event.altKey) modifiers.push("Alt");
        if (event.metaKey) modifiers.push("Meta");
        const panicKeybind = [...modifiers, key].join("+");
        panicKeybindInput.value = panicKeybind;
      }

      function saveTheme(theme = document.getElementById("theme-select").value) {
        localStorage.setItem("theme", theme);
        loadTheme(theme);
      }

      function enableParticles() {
        if (!document.getElementById("particles-js")) {
          const particlesDiv = document.createElement("div");
          particlesDiv.id = "particles-js";
          particlesDiv.style.position = "fixed";
          particlesDiv.style.top = "0";
          particlesDiv.style.left = "0";
          particlesDiv.style.width = "100%";
          particlesDiv.style.height = "100%";
          particlesDiv.style.zIndex = "-1";
          document.body.appendChild(particlesDiv);
        }
        particlesJS("particles-js", {
          "particles": {
            "number": {
              "value": 100,
              "density": {
                "enable": true,
                "value_area": 800
              }
            },
            "color": {
              "value": "#ffffff"
            },
            "shape": {
              "type": "circle",
              "stroke": {
                "width": 0,
                "color": "#000000"
              }
            },
            "opacity": {
              "value": 0.5,
              "random": false
            },
            "size": {
              "value": 3,
              "random": true
            },
            "line_linked": {
              "enable": true,
              "distance": 150,
              "color": "#ffffff",
              "opacity": 0.4,
              "width": 1
            },
            "move": {
              "enable": true,
              "speed": 3,
              "direction": "none",
              "random": false,
              "straight": false,
              "out_mode": "out"
            }
          },
          "interactivity": {
            "detect_on": "canvas",
            "events": {
              "onhover": {
                "enable": true,
                "mode": "grab"
              },
              "onclick": {
                "enable": true,
                "mode": "push"
              },
              "resize": true
            },
            "modes": {
              "grab": {
                "distance": 200,
                "line_linked": {
                  "opacity": 1
                }
              },
              "bubble": {
                "distance": 400,
                "size": 40,
                "duration": 2,
                "opacity": 8,
                "speed": 3
              },
              "repulse": {
                "distance": 100,
                "duration": 0.4
              },
              "push": {
                "particles_nb": 4
              },
              "remove": {
                "particles_nb": 2
              }
            }
          },
          "retina_detect": true
        });
        console.log("Particles enabled");
      }

      function disableParticles() {
        const particlesDiv = document.getElementById("particles-js");
        if (particlesDiv) {
          particlesDiv.parentNode.removeChild(particlesDiv);
          console.log("Particles disabled");
        }
      }
    </script>
  </body>
</html>
